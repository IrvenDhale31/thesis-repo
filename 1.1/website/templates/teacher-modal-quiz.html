<style>
    /* Dark mode styles */
    body.modal-open {
        font-family: 'ProductSansBold', sans-serif;
    }

    #quizModal {
        font-family: 'ProductSansBold', sans-serif;
    }

    #quizModalLabel {
        font-family: 'ProductSansBold', sans-serif;
    }

    .modal-content {
        font-family: 'ProductSansBold', sans-serif;
        background-color: #333;
        color: white;
    }

    .modal-header {
        background-color: #222;
        border-color: #111;
    }

    .modal-body {
        background-color: #444;
    }

    .modal-footer {
        background-color: #222;
        border-color: #111;
    }

    /* Add more specific CSS selectors for other elements as needed */
    /* For example, you can customize the styles of input fields, labels, buttons, etc. */
</style>

<!-- Quiz Modal -->
<div class="modal fade dark-mode" id="quizModal" tabindex="-1" aria-labelledby="quizModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="quizModalLabel">Create Quiz</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="quizForm" method="post">
                    <div class="mb-3">
                        <label for="quizTitle" class="form-label">Quiz Title</label>
                        <input type="text" class="form-control" id="quizTitle" placeholder="Enter quiz title" required>
                    </div>
                    <div class="mb-3">
                        <label for="quizInstructions" class="form-label">Instructions</label>
                        <textarea class="form-control" id="quizInstructions" rows="3" placeholder="Enter quiz instructions"></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="quizTimer" class="form-label">Timer (minutes)</label>
                        <input type="number" class="form-control" id="quizTimer" placeholder="Enter quiz timer" required>
                    </div>
                    <div id="questionContainer">
                        <!-- Questions will be added here -->
                    </div>
                    <button type="button" class="btn btn-primary mt-3" id="addQuestionBtn">Add Question</button>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-warning" id="createQuizBtn">CREATE</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    const questionContainer = document.getElementById("questionContainer");
    let questionNumber = 1;

    function createQuestionElement(number) {
        const questionDiv = document.createElement("div");
        questionDiv.classList.add("mb-4");

        questionDiv.innerHTML = `
            <h5>Question ${number}</h5>
            <label for="question_${number}" class="form-label">Question:</label>
            <input type="text" id="question_${number}" class="form-control">
            <label for="questionType_${number}" class="form-label">Question Type:</label>
            <select id="questionType_${number}" class="form-control">
                <option value="multiple_choice">Multiple Choice</option>
                <option value="identification">Identification</option>
                <option value="true_false">True/False</option>
            </select>
            <div id="optionsContainer_${number}" class="mt-3"></div>
            <label for="correct_${number}" class="form-label">Correct Answer:</label>
            <input type="text" id="correct_${number}" class="form-control" placeholder="Enter correct answer">
            <hr>
        `;

        return questionDiv;
    }

    function createOptionsInput(number) {
        const optionsInput = document.createElement("div");
        optionsInput.id = `optionsContainer_${number}`;

        for (let i = 0; i < 4; i++) {
            const optionLabel = String.fromCharCode(65 + i); // "A", "B", "C", "D"
            const optionDiv = document.createElement("div");
            optionDiv.classList.add("mb-2");

            optionDiv.innerHTML = `
                <label for="option_${number}_${i}" class="form-label">${optionLabel}:</label>
                <input type="text" id="option_${number}_${i}" class="form-control" placeholder="Enter option ${optionLabel}">
            `;

            optionsInput.appendChild(optionDiv);
        }

        return optionsInput;
    }

    function createQuestionTypeListener(number) {
        return function () {
            const optionsContainer = document.getElementById(`optionsContainer_${number}`);
            optionsContainer.innerHTML = "";
            
            const questionType = this.value;

            if (questionType === "multiple_choice") {
                const optionsInput = createOptionsInput(number);
                optionsContainer.appendChild(optionsInput);
            }
        };
    }

    const addQuestionBtn = document.getElementById("addQuestionBtn");
    addQuestionBtn.addEventListener("click", function () {
        const questionDiv = createQuestionElement(questionNumber);
        questionContainer.appendChild(questionDiv);

        const questionTypeSelect = document.getElementById(`questionType_${questionNumber}`);
        questionTypeSelect.addEventListener("change", createQuestionTypeListener(questionNumber));

        questionNumber++;
    });

    const createQuizBtn = document.getElementById("createQuizBtn");
    createQuizBtn.addEventListener("click", function () {
        const quizTitle = document.getElementById("quizTitle").value;
        const questions = [];

        let allFieldsFilled = true; // Flag to check if all fields are filled

        for (let i = 1; i < questionNumber; i++) {
            const question = document.getElementById(`question_${i}`).value;
            const questionType = document.getElementById(`questionType_${i}`).value;
            const options = [];

            if (questionType === "multiple_choice") {
                for (let j = 0; j < 4; j++) {
                    const option = document.getElementById(`option_${i}_${j}`).value;
                    options.push(option);
                }
            }

            const correctAnswer = document.getElementById(`correct_${i}`).value;

            // Check if any field is empty
            if (!question || !questionType || (questionType === "multiple_choice" && options.some(option => !option)) || !correctAnswer) {
                allFieldsFilled = false;
                alert(`Please fill out all fields for Question ${i}`);
                break;
            }

            questions.push({
                question: question,
                questionType: questionType,
                options: options,
                correctAnswer: correctAnswer
            });
        }

        if (allFieldsFilled) {
            const quizData = {
                quizTitle: quizTitle,
                questions: questions
            };

            // TODO: Send the quizData to the server using fetch or AJAX
            console.log(quizData);
        }
    });

    const quizForm = document.getElementById("quizForm");
quizForm.addEventListener("submit", function (event) {
    event.preventDefault(); // Prevent the form from submitting and reloading the page

    // Your code to handle form submission (AJAX/Fetch request) should go here
});

</script>
